#upsm
https://github.com/psemiletov/upsm

   РУКОВОДСТВО

   upsm это основанный на Qt монитор ИБП (фронт-энд к утилите upsc из состава Network UPS Tools). Он сидит в области уведомлений и запрашивает показания напряжения от nut-сервера используя upsc, поэтому вам нужно сначала настроить NUT, о чем я поведаю чуть ниже.
   В Настройках upsm нужно задать команду вызова upsc, например "upsc myups", и периодичность опроса сервера, в миллисекундах.
   Кнопка "закрыть" программы завершает работу программы (если в настройках не выбрано "Скрывать с панели задач"), а кнопка "свернуть" - сворачивает в область уведомлений.
   Перейдем теперь к насущному вопросу.

   Как настроить NUT-сервер?

1. Даем команду lsusb, смотрим vendor id производителя УПС, например:

Bus 003 Device 004: ID 0d9f:0004 Powercom Co., Ltd
vendor id здесь = 0d9f
а шина = 003

2. Из /lib/udev/rules.d копируем файл с "именем число-nut-usbups.rules" в каталог /etc/udev/rules.d, если такового файла там еще нет.

3. Правим файл /etc/nut/ups.conf, добавляя в конец примерно такое:
[myups]
    driver = usbhid-ups
    port = auto
    desc = "My ups"
    vendorid = 0d9f
    pollfreq = 30

В vendorid прописываем полученный из lsusb вендор ид. pollfreq = частота опроса устройства, в секундах. Можно написать еще bus, где указать полученный номер шины, однако в Linux номера шины иногда меняются после перезагрузки.

4. Для пробы запускаем драйвер:

upsdrvctl start

5. Запускаем сервер:

upsd

6. Пробуем прочитать данные с ИБП:

upsc myups

7. Прописываем эту строку в качестве команды опроса в настройках upsm.


Петр Семилетов <peter.semiletov@gmail.com>

